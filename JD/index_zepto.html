<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JD京东</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <!-- <script type="text/javascript" src="js/index.js"></script> -->
    <!-- <script src="zepto-master/src/zepto.js"></script> -->
    <!-- <script src="js/zepto.min.js"></script>
    <script src="zepto-master/src/selector.js"></script>
    <script src="zepto-master/src/fx.js"></script>
    <script src="zepto-master/src/touch.js"></script> -->
    <script src="zepto-master/dist/zepto.min.js"></script>
</head>
<body>
    <div class="mhome">
        <!-- 搜索框 -->
        <div class="jd_search">
            <a href="javascript:;" class='jd_logo'></a>
            <form action="" class='jd_searchBox'>
                <input type="text" placeholder="请输入商品名称">
            </form>
            <a href="javascript:;" class='jd_message'>消息</a>
        </div>
        <div class="jd_banner">
           <ul class="jd_bannerImg clearfix">
               <li><img src="uploads/l1.jpg" alt=""></li>
               <li><img src="uploads/l2.jpg" alt=""></li>
               <li><img src="uploads/l3.jpg" alt=""></li>
               <li><img src="uploads/l4.jpg" alt=""></li>
               <li><img src="uploads/l5.jpg" alt=""></li>
               <li><img src="uploads/l6.jpg" alt=""></li>
               <li><img src="uploads/l7.jpg" alt=""></li>
               <li><img src="uploads/l8.jpg" alt=""></li>
           </ul>
           <ul class='jd_bannerIndicator'>
               <li class='action'></li>
               <li></li>
               <li></li>
               <li></li>
               <li></li>
               <li></li>
               <li></li>
               <li></li>
           </ul>
         </div>
       <!-- 导航栏部分 -->
         <div class="jd_nav">
           <ul class='clearfix'>
               <li><a href="javascript:;"><img src="uploads/nav0.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav1.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav2.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav3.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav4.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav5.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav6.png" alt=""><p>商品分类</p></a></li>
               <li><a href="javascript:;"><img src="uploads/nav7.png" alt=""><p>商品分类</p></a></li>
           </ul>
        </div>
        <div class="jd_product">
            <div class="jd_productBox">
                <div class='jd_secKill'>
                    <div class='jd_sLeft'>
                        <span class="jd_skIcon f_left m_left10"></span>
                        <span class='jd_sk_txt f_left m_left10'>掌上秒杀</span>
                        <div class='jd_countdown f_left m_left10' >
                            <span>0</span>
                            <span>0</span>
                            <span>:</span>
                            <span>0</span>
                            <span>0</span>
                            <span>:</span>
                            <span>0</span>
                            <span>0</span>
                        </div>
                    </div>
                    <div class='f_right m_right10'><span>更多秒杀...</span></div>
                </div>
                <div class='jd_pContent clearfix'>
                    <ul>
                        <li><img src="images/detail01.jpg" alt=""><p>10$</p><p>20$</p></li>
                        <li><img src="images/detail01.jpg" alt=""><p>10$</p><p>20$</p></li>
                        <li><img src="images/detail01.jpg" alt=""><p>10$</p><p>20$</p></li>
                    </ul>
                </div>
             </div>
            <div class="jd_productBox">
                <div class="jd_title">
                    <h3>京东超市</h3>
                </div>
                <div class="jd_pSubtance clearfix">
                    <a href="javascript:;" class= 'a_50 f_left b_right'><img src="images/cp1.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_right b-bottom'><img src="images/cp2.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_right'><img src="images/cp3.jpg" alt=""></a>
                </div>
            </div>


            <div class="jd_productBox">
                <div class="jd_title">
                    <h3>京东超市</h3>
                </div>
                <div class="jd_pSubtance clearfix">
                    <a href="javascript:;" class= 'a_50 f_right'><img src="images/cp4.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_left b-left'><img src="images/cp5.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_left b_bottom'><img src="images/cp6.jpg" alt=""></a>

                </div>
            </div>

            <div class="jd_productBox">
                <div class="jd_title">
                    <h3>京东超市</h3>
                </div>
                <div class="jd_pSubtance clearfix">
                    <a href="javascript:;" class= 'a_50 f_left b_right'><img src="images/cp1.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_right b-bottom'><img src="images/cp2.jpg" alt=""></a>
                    <a href="javascript:;" class= 'a_50 f_right'><img src="images/cp3.jpg" alt=""></a>
                </div>
            </div>

        </div>
    </div>
    <script>
    // 使用zepto实现轮播图
/*  1.添加收尾图片
    2.重新设置图片盒子的宽度和图片的宽度
    3.开启定时器,实现自动轮播
    4.添加移动端的滑动事件,实现手动轮播
    5.添加过渡效果之后的监听 */
    $(function(){
        var banner = $('.jd_banner');
        var bannerWidth = banner.width();
        // 获取图片盒子
        var bannerImg = banner.find('ul:first-of-type');
        // 获取小圆点
        var indicators = banner.find('ul:eq(1)').find('li');
        // console.log(indicators);
        var first = bannerImg.find('li:first-of-type');
        var last = bannerImg.find('li:last-of-type');
        // 将两张图片添加到头尾
        bannerImg.append(first.clone());
        last.clone().insertBefore(first);

        // 设置图片盒子的宽度
       
        var lis = bannerImg.find('li');
        var count = lis.length;
        console.log(count);
        bannerImg.width(count * bannerWidth + 'px');
      /*   for(var i = 0; i< count; i++){
            var li = lis[i];
            li.width(bannerWidth);
        } */
         // 设置li标签的宽度
         lis.each(function(index,value){
             $(lis[index]).width(bannerWidth);
         })
        //  设置默认偏移
        bannerImg.css('left', -bannerWidth);

        // 开启定时器
        var index = 1;
            // 在zepto中直接使用animate函数实现
        /*  1.需要添加动画样式-对象
            2.动画耗时
            3.动画的速度函数 animation-timing-function 
            4.当前动画执行完毕之后的回调 */
        var imgAnimation=function(){
            bannerImg.animate(
                {"left": -index*bannerWidth},
                200,
                "ease-in-out",
                function(){//动画执行完毕之后的回调
                    if (index == count - 1){
                        index = 1;
                        bannerImg.css('left', -index*bannerWidth);
                        
                    }
                    else if(index == 0){
                        index = count-2;
                        bannerImg.css('left', -index*bannerWidth);
                    }
                    // 设置点标记
                    indicators.removeClass('action').eq(index-1).addClass('action');
                }
            );
        }
        // 计时器开启
         var timerId;
        var slideshown = function() {
        timerId = setInterval(function(){
            index++; 
            console.log(index);
            // indicators.removeClass('action').eq(index-1).addClass('action');
            imgAnimation();   
        },2000) 
        }
        slideshown();

        // 添加滑动事件
        /*在谷歌浏览器的模拟器中，无法正确的触发swipe相关事件，但是可以触发tap事件*/
        // 左滑
        bannerImg.on('swipeLeft',function(){
            console.log('swipeLeft');
            index++;
            clearInterval(timerId);
            imgAnimation();
            slideshown();


        });
        // 右滑
        bannerImg.on('swipeRight',function(){
            console.log('swipeRight');

            index--;
            clearInterval(timerId);
            imgAnimation();
            slideshown();          



        })

    })
    
    </script>
</body>
</html>
